#!/bin/bash

# 변수 초기화
{
  "분류": "Host OS",
  "코드": "5.2",
  "위험도": "중요도 하",
  "진단_항목": "etcd 데이터 디렉터리 권한 설정",
  "대응방안": {
    "설명": "etcd는 중요한 데이터를 저장하는 key-value 저장소로, Kubernetes에서 중요한 설정과 상태 정보를 저장합니다. 이러한 데이터의 보안을 보장하기 위해 etcd 데이터 디렉터리는 무단 접근으로부터 보호되어야 합니다.",
    "설정방법": [
      "etcd 데이터 디렉터리의 사용자 및 그룹 권한 설정: chmod 700 /var/lib/etcd",
      "etcd 데이터 디렉터리의 소유권 변경: chown etcd:etcd /var/lib/etcd"
    ]
  },
  "현황": [],
  "진단_결과": ""
}


# etcd 데이터 디렉터리 권한 확인
echo "etcd 데이터 디렉터리 권한을 확인합니다..."
ls -alR /var/lib/etcd

# 파일 권한 설정
chmod 700 /var/lib/etcd
chown etcd:etcd /var/lib/etcd

# 결과 JSON 출력
echo "{
  \"분류\": \"$분류\",
  \"코드\": \"$코드\",
  \"위험도\": \"$위험도\",
  \"진단_항목\": \"$진단_항목\",
  \"대응방안\": \"$대응방안\",
  \"현황\": $현황,
  \"진단_결과\": \"$진단_결과\"
}"
